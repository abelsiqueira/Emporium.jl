<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · Emporium.jl</title><script data-outdated-warner src="assets/warner.js"></script><link rel="canonical" href="https://abelsiqueira.github.io/Emporium.jl/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>Emporium.jl</a></span></div><form class="docs-search" action="search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/abelsiqueira/Emporium.jl/blob/main/docs/src/index.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Emporium"><a class="docs-heading-anchor" href="#Emporium">Emporium</a><a id="Emporium-1"></a><a class="docs-heading-anchor-permalink" href="#Emporium" title="Permalink"></a></h1><p>Documentation for <a href="https://github.com/abelsiqueira/Emporium.jl">Emporium</a>.</p><ul><li><a href="#Emporium.check_and_fix_compliance"><code>Emporium.check_and_fix_compliance</code></a></li><li><a href="#Emporium.clone_organization_repos"><code>Emporium.clone_organization_repos</code></a></li><li><a href="#Emporium.create_pull_request-NTuple{4, Any}"><code>Emporium.create_pull_request</code></a></li><li><a href="#Emporium.create_test_project_from_main_project-Tuple{}"><code>Emporium.create_test_project_from_main_project</code></a></li><li><a href="#Emporium.git_has_modifications_to_stage-Tuple{}"><code>Emporium.git_has_modifications_to_stage</code></a></li><li><a href="#Emporium.git_has_staged_to_commit-Tuple{}"><code>Emporium.git_has_staged_to_commit</code></a></li><li><a href="#Emporium.git_has_to_commit-Tuple{}"><code>Emporium.git_has_to_commit</code></a></li><li><a href="#Emporium.run_on_folders-Tuple{Any, Any}"><code>Emporium.run_on_folders</code></a></li></ul><article class="docstring"><header><a class="docstring-binding" id="Emporium.check_and_fix_compliance" href="#Emporium.check_and_fix_compliance"><code>Emporium.check_and_fix_compliance</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">check_and_fix_compliance(template_folder, file_list, workdir = &quot;cloned_repos&quot;; options...)</code></pre><p>Compares the list of files given in <code>file_list</code> for every package in <code>workdir</code> with the same files in <code>template_folder</code>. If some cases, the template files have a package name placeholder that needs to be replaced by the actual package name. Set this with the keyword variable <code>template_pkg_name</code>.</p><p><strong>Keywords arguments</strong></p><ul><li><code>auth</code>: GitHub.jl authentication token (use <code>GitHub.authenticate(YOUR_TOKEN)</code>).</li><li><code>check_only::Bool</code>: If true, will display only the comparison, without fixing anything (default: <code>false</code>).</li><li><code>close_older_compliance_prs::Bool</code>: If <code>create_pr</code> is enabled, and this is true, it will look for other PRs with the same branch name prefix and close them (default: <code>true</code>).</li><li><code>create_pr::Bool</code>: Whether to create a pull request, or just the commits. Requires a valid <code>auth</code> key (default: <code>false</code>).</li><li><code>filter_jl_ending::Bool</code>: Whether to check only folders ending in <code>.jl</code> or all folders (default: <code>true</code>).</li><li><code>info_header_frequency::Int</code>: How often to show the header with the file names (default: <code>5</code>).</li><li><code>owner::String</code>: If <code>create_pr</code> is true, then this is the owner of the repo, and can&#39;t be empty. The full url of the repo is <code>https://github.com/$owner/$pkg</code>, where <code>pkg</code> is the folder name (default: &quot;&quot;).</li><li><code>rename_these_files::Vector{Pair{String, String}}</code>: List of files to be renamed, if they exist. This will be done before fixing the content with new files. Each pair is of the form <code>old =&gt; new</code> (default: []).</li><li><code>template_pkg_name::String</code>: The placeholder for the package name in the files.</li></ul><p><strong>Extended help</strong></p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">julia&gt; clone_organization_repos(&quot;MyOrg&quot;, &quot;cloned_repos&quot;, exclude=[&quot;MyTemplate.jl&quot;]) # Clone from my org into repos
julia&gt; run(`git clone https://github.com/MyOrg/MyTemplate.jl`)
julia&gt; auth = GitHub.authenticate(ENV[&quot;GITHUB_TOKEN&quot;])
julia&gt; check_and_fix_compliance(
           &quot;MyTemplate.jl&quot;,
           [&quot;.JuliaFormatter.jl&quot;, &quot;.github/workflows/CI.yml&quot;],
           &quot;cloned_repos&quot;,
           auth = auth,
           check_only = false,
           close_older_compliance_prs = true,
           create_pr = true,
           owner = &quot;MyOrg&quot;,
           rename_these_files = [&quot;.github/workflows/ci.yml&quot;  =&gt; &quot;.github/workflows/CI.yml&quot;],
           template_pkg_name = &quot;MyTemplate&quot;,
       )</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/abelsiqueira/Emporium.jl/blob/58be80ebe1613e9ca53fee412198c40f2d72df70/src/template-compliance.jl#L3-L42">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Emporium.clone_organization_repos" href="#Emporium.clone_organization_repos"><code>Emporium.clone_organization_repos</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">clone_organization_repos(org; options...)
clone_organization_repos(org, dest; options...)</code></pre><p>Clone all repos from the GitHub organization <code>org</code> into folder <code>dest</code>. If <code>dest</code> is not specified, used <code>dest = org</code>.</p><p>Options:</p><ul><li><code>auth = AnonymousAuth()</code>: Authentication token (<code>GitHub.authenticate(ENV[&quot;GITHUB_AUTH&quot;])</code>)</li><li><code>dry_run = false</code>: Don&#39;t clone the repos, only list them.</li><li><code>exclude = []</code>: Exclude listed repos.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/abelsiqueira/Emporium.jl/blob/58be80ebe1613e9ca53fee412198c40f2d72df70/src/github.jl#L3-L15">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Emporium.create_pull_request-NTuple{4, Any}" href="#Emporium.create_pull_request-NTuple{4, Any}"><code>Emporium.create_pull_request</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">pr = create_pull_request(repo, title, body, head; options...)</code></pre><p>Very thin layer over GitHub.create<em>pull</em>request. Creates a pull request to <code>repo</code> from branch <code>head</code> to base <code>base</code> (defaults to <code>main</code>). The <code>title</code> and <code>body</code> must be supplied.</p><p><strong>Options</strong></p><ul><li><code>auth = GitHub.AnonymousAuth()</code>: GitHub authentication token</li><li><code>base = &quot;main&quot;</code>: Main branch where you want to merge the changes</li><li><code>dry_run = false</code>: Test instead of actually running</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/abelsiqueira/Emporium.jl/blob/58be80ebe1613e9ca53fee412198c40f2d72df70/src/github.jl#L41-L53">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Emporium.create_test_project_from_main_project-Tuple{}" href="#Emporium.create_test_project_from_main_project-Tuple{}"><code>Emporium.create_test_project_from_main_project</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">create_test_project_from_main_project()</code></pre><p>Create <code>test/Project.toml</code> from the sections [extras] and [targets] in <code>Project.toml</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/abelsiqueira/Emporium.jl/blob/58be80ebe1613e9ca53fee412198c40f2d72df70/src/create-test-project-from-main-project.jl#L5-L9">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Emporium.git_has_modifications_to_stage-Tuple{}" href="#Emporium.git_has_modifications_to_stage-Tuple{}"><code>Emporium.git_has_modifications_to_stage</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">git_has_modifications_to_stage()</code></pre><p>Check for modified unstaged files.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/abelsiqueira/Emporium.jl/blob/58be80ebe1613e9ca53fee412198c40f2d72df70/src/git-aux.jl#L6-L10">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Emporium.git_has_staged_to_commit-Tuple{}" href="#Emporium.git_has_staged_to_commit-Tuple{}"><code>Emporium.git_has_staged_to_commit</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">git_has_staged_to_commit()</code></pre><p>Check for staged files</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/abelsiqueira/Emporium.jl/blob/58be80ebe1613e9ca53fee412198c40f2d72df70/src/git-aux.jl#L15-L19">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Emporium.git_has_to_commit-Tuple{}" href="#Emporium.git_has_to_commit-Tuple{}"><code>Emporium.git_has_to_commit</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">git_has_to_commit()</code></pre><p>Check for unstaged or staged modifications to commit. Doesn&#39;t check for untracked files.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/abelsiqueira/Emporium.jl/blob/58be80ebe1613e9ca53fee412198c40f2d72df70/src/git-aux.jl#L24-L29">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Emporium.run_on_folders-Tuple{Any, Any}" href="#Emporium.run_on_folders-Tuple{Any, Any}"><code>Emporium.run_on_folders</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">run_on_folders(action, folders)
run_on_folders(action, folders)</code></pre><p>Run <code>action</code> into each folder in <code>folders</code>. <code>action</code> must be either:</p><ul><li>a <code>Cmd</code> (like <code>ls</code>, or <code>git status</code>).</li><li>a callable with no mandatory arguments with some keyword arguments, but that accepts arbitrary commands.</li></ul><p>The following keyword arguments will be passed to <code>action</code>:</p><ul><li><code>basename</code>: Folder name stripped of dirs before it.</li><li><code>dirname</code>: Complement of <code>basename</code>.</li><li><code>index</code>: Index of traversal in <code>folders</code>, obtained from <code>enumerate(folder_list)</code>.</li></ul><p>If you think of something useful to add to this list, let me know.</p><p><strong>Options</strong></p><ul><li><code>dry_run = false</code>: Don&#39;t run the action, just print.</li><li><code>rethrow_exception = false</code>: If an exception is thrown by the action, rethrow it.</li></ul><p><strong>Examples</strong></p><p><strong>Updating a file throught your cloned repos</strong></p><p>You want to have the same configuration in all your repos, that are cloned into folder &quot;cloned-repos&quot;.</p><pre><code class="language-julia-repl hljs">julia&gt; myfile = joinpath(pwd(), &quot;.editorconfig&quot;)
julia&gt; folders = readdir(&quot;cloned-repos&quot;, join=true)
julia&gt; run_on_folders(`cp $myfile .`, folders)
julia&gt; run_on_folders((;kws...) -&gt;
       if git_has_to_commit() &amp;&amp; run(`git commit -am &quot;Add or update&quot;`), folders)
julia&gt; run_on_folders(`git push`, folders)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/abelsiqueira/Emporium.jl/blob/58be80ebe1613e9ca53fee412198c40f2d72df70/src/folder-activities.jl#L3-L40">source</a></section></article></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Sunday 15 January 2023 12:17">Sunday 15 January 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
